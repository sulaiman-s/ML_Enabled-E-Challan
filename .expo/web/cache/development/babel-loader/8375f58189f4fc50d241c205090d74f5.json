{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { DefaultTheme, NavigationContainer } from \"@react-navigation/native\";\nimport jwtDecode from \"jwt-decode\";\nimport React, { useState, useEffect } from \"react\";\nimport { AsyncStorage } from \"react-native-web/dist/index\";\nimport SectionList from \"react-native-web/dist/exports/SectionList\";\nimport AuthContext from \"./app/Authorization/Context\";\nimport { SavedToken } from \"./app/Authorization/JwtToken\";\nimport AdminDrawer from \"./app/navigation/AdminNavigation\";\nimport AuthNavigator from \"./app/navigation/AuthNavigation\";\nimport UserDrawer from \"./app/navigation/UserNavigation\";\nimport AppLoading from \"expo-app-loading\";\nimport axios from \"axios\";\nimport Url from \"./app/Authorization/ApiUrlEndpoints\";\nexport default function App() {\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      profilePic = _useState4[0],\n      setProfilePic = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      ready = _useState6[0],\n      setReady = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      check = _useState8[0],\n      seCheck = _useState8[1];\n\n  var Check_user_InMemory = function Check_user_InMemory() {\n    if (!user) {\n      AsyncStorage.getItem(\"JwtToken\").then(function (t) {\n        return JSON.parse(t);\n      }).then(function (tk) {\n        if (tk != null || tk != undefined) {\n          SavedToken(tk.refresh);\n          var u = jwtDecode(tk.refresh);\n\n          if (u.exp < Date.now()) {\n            setUser(u);\n            axios.get(Url + \"/user/profile/\" + u.name).then(function (res) {\n              if (res.data.length > 0) {\n                setProfilePic(res.data[0]);\n              } else {\n                setProfilePic(null);\n              }\n            }).catch(function (error) {\n              return console.log(error);\n            });\n          }\n\n          seCheck(true);\n        } else {\n          seCheck(true);\n        }\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    }\n  };\n\n  var checker = function checker() {\n    if (check) {\n      if (user) {\n        if (!user.is_admin) {\n          return React.createElement(UserDrawer, null);\n        } else if (user.is_admin) {\n          return React.createElement(AdminDrawer, null);\n        }\n      } else return React.createElement(AuthNavigator, null);\n    }\n  };\n\n  if (!ready) {\n    React.createElement(AppLoading, {\n      startAsync: Check_user_InMemory(),\n      onFinish: function onFinish() {\n        return setReady(true);\n      },\n      onError: function onError(error) {\n        return console.log(error);\n      }\n    });\n  }\n\n  return React.createElement(AuthContext.Provider, {\n    value: {\n      user: user,\n      setUser: setUser,\n      profilePic: profilePic,\n      setProfilePic: setProfilePic\n    }\n  }, React.createElement(NavigationContainer, null, checker()));\n}","map":{"version":3,"names":["DefaultTheme","NavigationContainer","jwtDecode","React","useState","useEffect","AsyncStorage","AuthContext","SavedToken","AdminDrawer","AuthNavigator","UserDrawer","AppLoading","axios","Url","App","user","setUser","profilePic","setProfilePic","ready","setReady","check","seCheck","Check_user_InMemory","getItem","then","t","JSON","parse","tk","undefined","refresh","u","exp","Date","now","get","name","res","data","length","catch","error","console","log","checker","is_admin"],"sources":["C:/Users/sulai/Desktop/fyp/FYP/aut_Veh_num_det/Auto_Veh_front_end/App.js"],"sourcesContent":["import { DefaultTheme, NavigationContainer } from \"@react-navigation/native\";\nimport jwtDecode from \"jwt-decode\";\nimport React, { useState, useEffect } from \"react\";\nimport { AsyncStorage, SectionList } from \"react-native\";\nimport AuthContext from \"./app/Authorization/Context\";\nimport { SavedToken } from \"./app/Authorization/JwtToken\";\nimport AdminDrawer from \"./app/navigation/AdminNavigation\";\nimport AuthNavigator from \"./app/navigation/AuthNavigation\";\nimport UserDrawer from \"./app/navigation/UserNavigation\";\nimport AppLoading from \"expo-app-loading\";\nimport axios from \"axios\";\nimport Url from \"./app/Authorization/ApiUrlEndpoints\";\nexport default function App() {\n  const [user, setUser] = useState();\n  const [profilePic, setProfilePic] = useState({});\n  const [ready, setReady] = useState(false);\n  const [check, seCheck] = useState(false);\n\n  const Check_user_InMemory = () => {\n    if (!user) {\n      AsyncStorage.getItem(\"JwtToken\")\n        .then((t) => {\n          return JSON.parse(t);\n        })\n        .then((tk) => {\n          if (tk != null || tk != undefined) {\n            SavedToken(tk.refresh);\n            const u = jwtDecode(tk.refresh);\n            if (u.exp < Date.now()) {\n              setUser(u);\n              axios\n                .get(Url + \"/user/profile/\" + u.name)\n                .then((res) => {\n                  if (res.data.length > 0) {\n                    setProfilePic(res.data[0]);\n                  } else {\n                    setProfilePic(null);\n                  }\n                })\n                .catch((error) => console.log(error));\n            }\n            seCheck(true);\n          } else {\n            seCheck(true);\n          }\n        })\n        .catch((error) => console.log(error));\n    }\n  };\n\n  const checker = () => {\n    if (check) {\n      if (user) {\n        if (!user.is_admin) {\n          return <UserDrawer />;\n        } else if (user.is_admin) {\n          return <AdminDrawer />;\n        }\n      } else return <AuthNavigator />;\n    }\n  };\n\n  if (!ready) {\n    <AppLoading\n      startAsync={Check_user_InMemory()}\n      onFinish={() => setReady(true)}\n      onError={(error) => console.log(error)}\n    />;\n  }\n  return (\n    <AuthContext.Provider value={{ user, setUser, profilePic, setProfilePic }}>\n      <NavigationContainer>{checker()}</NavigationContainer>\n    </AuthContext.Provider>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}